name: Release

on:
    release:
        types: [published]

jobs:
    tag:
        name: New release
        runs-on: ubuntu-latest
        steps:
            - name: Checkout code
              uses: actions/checkout@v4

            - name: Build
              run: |
                  # Remove development files
                  rm -rf .git
                  rm -rf .github
                  rm -f .gitignore
                  rm -f README.md
                  rm -f CHANGELOG.md

            - name: Upload release asset
              uses: actions/upload-release-asset@v1
              env:
                  GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
              with:
                  upload_url: ${{ github.event.release.upload_url }}
                  asset_path: ${{ steps.deploy.outputs.zip-path }}
                  asset_name: recompal.zip
                  asset_content_type: application/zip
